{"ast":null,"code":"import _regeneratorRuntime from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _createClass from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/filipzupancic/KriptalBets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/filipzupancic/KriptalBets/src/components/App.js\";\nimport React, { Component } from 'react';\nimport Web3 from 'web3';\nimport './App.css';\nimport bet from '../abis/bet.json';\nimport Navbar from './Navbar';\nimport Main from './Main';\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n  _createClass(App, [{\n    key: \"componentWillMount\",\n    value: function () {\n      var _componentWillMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.loadWeb3();\n              case 2:\n                _context.next = 4;\n                return this.loadBlockchainData();\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function componentWillMount() {\n        return _componentWillMount.apply(this, arguments);\n      }\n      return componentWillMount;\n    }()\n  }, {\n    key: \"loadWeb3\",\n    value: function () {\n      var _loadWeb = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!window.ethereum) {\n                  _context2.next = 6;\n                  break;\n                }\n                window.web3 = new Web3(window.ethereum);\n                _context2.next = 4;\n                return window.ethereum.enable();\n              case 4:\n                _context2.next = 7;\n                break;\n              case 6:\n                if (window.web3) {\n                  window.web3 = new Web3(window.web3.currentProvider);\n                } else {\n                  window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n                }\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      function loadWeb3() {\n        return _loadWeb.apply(this, arguments);\n      }\n      return loadWeb3;\n    }()\n  }, {\n    key: \"loadBlockchainData\",\n    value: function () {\n      var _loadBlockchainData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var web3, accounts, networkId, networkData, Bet;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                web3 = window.web3;\n                _context3.next = 3;\n                return web3.eth.getAccounts();\n              case 3:\n                accounts = _context3.sent;\n                this.setState({\n                  account: accounts[0]\n                });\n                _context3.next = 7;\n                return web3.eth.net.getId();\n              case 7:\n                networkId = _context3.sent;\n                networkData = bet.networks[networkId];\n                if (networkData) {\n                  Bet = web3.eth.Contract(bet.abi, networkData.address);\n                  console.log(networkData.address);\n                  this.setState({\n                    Bet: Bet\n                  });\n                  // const owner = await Bet.methods.owna().call()\n                  // const totalBets = await Bet.methods.totalBetMoney().call()\n                  // const team1Bets = await Bet.methods.getTotalBetAmount(\"0\").call()\n                  // const team2Bets = await Bet.methods.getTotalBetAmount(\"1\").call()\n                  // console.log(owner.toString())\n                  // console.log(totalBets.toString())\n                  // console.log(team1Bets.toString())\n                  // console.log(team2Bets.toString())\n\n                  this.setState({\n                    loading: false\n                  });\n                } else {\n                  window.alert(\"Bet contract not deployed to detected network\");\n                }\n              case 10:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n      function loadBlockchainData() {\n        return _loadBlockchainData.apply(this, arguments);\n      }\n      return loadBlockchainData;\n    }()\n  }]);\n  function App(props) {\n    var _this;\n    _classCallCheck(this, App);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      account: '',\n      totalBetMoney: 0,\n      loading: true\n    };\n    _this.createBet = _this.createBet.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.teamWinDistribution = _this.teamWinDistribution.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n  _createClass(App, [{\n    key: \"teamWinDistribution\",\n    value: function () {\n      var _teamWinDistribution = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(teamId) {\n        var _this2 = this;\n        var totalBets;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                this.setState({\n                  loading: true\n                });\n                _context4.next = 3;\n                return this.state.Bet.methods.totalBetMoney().call();\n              case 3:\n                totalBets = _context4.sent;\n                totalBets = Number(totalBets);\n                this.state.Bet.methods.teamWinDistribution(teamId).send({\n                  from: this.state.account,\n                  value: window.web3.utils.toBN(totalBets)\n                }).once('receipt', function (receipt) {\n                  _this2.setState({\n                    loading: false\n                  });\n                });\n              case 6:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n      function teamWinDistribution(_x) {\n        return _teamWinDistribution.apply(this, arguments);\n      }\n      return teamWinDistribution;\n    }()\n  }, {\n    key: \"createBet\",\n    value: function createBet(name, teamId, betAmount) {\n      var _this3 = this;\n      this.setState({\n        loading: true\n      });\n      this.state.Bet.methods.createBet(name, teamId).send({\n        from: this.state.account,\n        value: betAmount\n      }).once('receipt', function (receipt) {\n        _this3.setState({\n          loading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, React.createElement(Navbar, {\n        account: this.state.account,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"container-fluid mt-5\",\n        style: {\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(\"main\", {\n        role: \"main\",\n        className: \"col-lg-12 d-flex\",\n        style: {\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, this.state.loading ? React.createElement(\"div\", {\n        id: \"loader\",\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, \"Loading...\")) : React.createElement(Main, {\n        createBet: this.createBet,\n        teamWinDistribution: this.teamWinDistribution,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      })))));\n    }\n  }]);\n  return App;\n}(Component);\nexport default App;","map":{"version":3,"names":["React","Component","Web3","bet","Navbar","Main","App","loadWeb3","loadBlockchainData","window","ethereum","web3","enable","currentProvider","alert","eth","getAccounts","accounts","setState","account","net","getId","networkId","networkData","networks","Bet","Contract","abi","address","console","log","loading","props","state","totalBetMoney","createBet","bind","teamWinDistribution","teamId","methods","call","totalBets","Number","send","from","value","utils","toBN","once","receipt","name","betAmount","alignItems","justifyContent"],"sources":["/Users/filipzupancic/KriptalBets/src/components/App.js"],"sourcesContent":["import React, { Component } from 'react';\nimport Web3 from 'web3'\nimport './App.css';\nimport bet from '../abis/bet.json'\nimport Navbar from './Navbar'\nimport Main from './Main'\n\nclass App extends Component {\n\n  async componentWillMount() {\n    await this.loadWeb3();\n    await this.loadBlockchainData();\n  }\n  \n  async loadWeb3() {\n    if (window.ethereum) {\n        window.web3 = new Web3(window.ethereum);\n        await window.ethereum.enable();\n    }\n    else if (window.web3) {\n        window.web3 = new Web3(window.web3.currentProvider);\n    }\n    else {\n        window.alert('Non-Ethereum browser detected. You should consider trying MetaMask!');\n    }\n  }\n\n  async loadBlockchainData() {\n    const web3 = window.web3\n\n    const accounts = await web3.eth.getAccounts()\n    this.setState({ account: accounts[0] })\n\n    const networkId = await web3.eth.net.getId()\n    const networkData = bet.networks[networkId]\n    if (networkData) {\n      const Bet = web3.eth.Contract(bet.abi, networkData.address)\n      console.log(networkData.address)\n      this.setState({ Bet })\n      // const owner = await Bet.methods.owna().call()\n      // const totalBets = await Bet.methods.totalBetMoney().call()\n      // const team1Bets = await Bet.methods.getTotalBetAmount(\"0\").call()\n      // const team2Bets = await Bet.methods.getTotalBetAmount(\"1\").call()\n      // console.log(owner.toString())\n      // console.log(totalBets.toString())\n      // console.log(team1Bets.toString())\n      // console.log(team2Bets.toString())\n\n      this.setState({ loading: false })\n\n    } else {\n      window.alert(\"Bet contract not deployed to detected network\")\n    }\n\n  }\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      account: '',\n      totalBetMoney: 0,\n      loading: true,\n    }\n\n    this.createBet = this.createBet.bind(this)\n    this.teamWinDistribution = this.teamWinDistribution.bind(this)\n\n  }\n\n  async teamWinDistribution(teamId) {\n    this.setState({ loading: true })\n    var totalBets = await this.state.Bet.methods.totalBetMoney().call()\n    totalBets = Number(totalBets)\n\n    this.state.Bet.methods.teamWinDistribution(teamId).send( { from: this.state.account, value: window.web3.utils.toBN(totalBets)})\n    .once('receipt', (receipt) => {\n      this.setState({ loading: false })\n    })\n  }\n\n  createBet(name, teamId, betAmount) {\n    this.setState({ loading: true })\n    this.state.Bet.methods.createBet(name, teamId).send( { from: this.state.account, value: betAmount})\n    .once('receipt', (receipt) => {\n      this.setState({ loading: false })\n    })\n  }\n  \n  render() {\n    return (\n      <div>\n        <Navbar account={this.state.account} />\n        <div className=\"container-fluid mt-5\" style={{ alignItems: 'center', justifyContent: 'center' }} >\n          <div className=\"row\">\n            <main role=\"main\" className=\"col-lg-12 d-flex\" style={{ alignItems: 'center', justifyContent: 'center' }}>\n              { this.state.loading \n                ? <div id=\"loader\" className=\"text-center\"><p className=\"text-center\">Loading...</p></div>\n                : <Main createBet = {this.createBet} teamWinDistribution = {this.teamWinDistribution} />\n              }\n            </main>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}